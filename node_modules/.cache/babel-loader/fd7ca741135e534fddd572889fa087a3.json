{"ast":null,"code":"import _toConsumableArray from\"D:/Business/Programming/react_lists/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _defineProperty from\"D:/Business/Programming/react_lists/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"D:/Business/Programming/react_lists/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"D:/Business/Programming/react_lists/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useContext}from'react';import styles from'./ItemCard.module.css';import{Link}from'react-router-dom';import{useClickOutside}from'../Helpers/ClickOutside';import{AppContext}from'../../context/AppContext';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export default function ItemCardItem(_ref){var item=_ref.item,maxIndex=_ref.maxIndex;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),itemMenu=_useState2[0],setItemMenu=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),moveMenu=_useState4[0],setMoveMenu=_useState4[1];var _useState5=useState(item),_useState6=_slicedToArray(_useState5,2),itemInput=_useState6[0],setItemInput=_useState6[1];var _useContext=useContext(AppContext),items=_useContext.items,children=_useContext.children,dispatch=_useContext.dispatch;var nextId=function nextId(){return items.reduce(function(id,item){return item.id>id?item.id:id;},0)+1;};var handleChange=function handleChange(e){var _ref2=[e.target.name,e.target.value],name=_ref2[0],value=_ref2[1];setItemInput(function(prev){return _objectSpread(_objectSpread({},prev),{},_defineProperty({},name,value));});};var handleTitleSave=function handleTitleSave(e){if(e.charCode===13)handleUpdate();};var handleUpdate=function handleUpdate(){if(!itemInput.title||/^\\s*$/.test(itemInput.title))return;dispatch({type:'UPDATE_ITEM',payload:itemInput});setItemMenu(false);};var handleCopy=function handleCopy(){var copy=JSON.parse(JSON.stringify(item));copy.id=nextId();copy.index=maxIndex;copy.title=item.title+' - copy';dispatch({type:'ADD_ITEM',payload:copy});setItemMenu(false);};var handleMoveMenu=function handleMoveMenu(){var availible=_toConsumableArray(items).filter(function(i){return item.id!==i.id&&item.parent!==i.id&&!children(item).includes(i);});setMoveMenu(availible);};var handleMove=function handleMove(e){var key=Number(e.target.dataset.key);var copy=_objectSpread({},item);copy.parent=key>0?key:null;copy.index=items.filter(function(i){return copy.parent===i.parent;}).length;console.log('index',copy.index);dispatch({type:'UPDATE_ITEM',payload:copy});setMoveMenu(null);setItemMenu(false);};var handleDelete=function handleDelete(){dispatch({type:'DELETE_ITEM',payload:item});setItemMenu(false);};var domMenu=useClickOutside(function(){setItemMenu(false);});return/*#__PURE__*/_jsxs(_Fragment,{children:[itemMenu&&/*#__PURE__*/_jsxs(\"div\",{ref:domMenu,children:[/*#__PURE__*/_jsx(\"div\",{onClick:function onClick(){return setItemMenu(false);},className:styles.underlay}),/*#__PURE__*/_jsxs(\"div\",{className:\"\".concat(styles.editWrap),children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Title\",value:itemInput.title,name:\"title\",className:\"z-depth-5 \".concat(styles.editInput),onChange:handleChange,onKeyPress:handleTitleSave}),/*#__PURE__*/_jsx(\"button\",{onClick:handleUpdate,className:\"btn secondary\",children:\"Save\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"z-depth-5 \".concat(styles.menuWrap),children:/*#__PURE__*/_jsxs(\"ul\",{children:[/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(\"i\",{onClick:function onClick(){return setItemMenu(false);},className:\"material-icons \".concat(styles.icon),children:\"close\"})}),/*#__PURE__*/_jsx(\"li\",{onClick:handleCopy,children:\"Copy\"}),/*#__PURE__*/_jsx(\"li\",{onClick:handleMoveMenu,children:\"Move\"}),moveMenu&&/*#__PURE__*/_jsx(\"li\",{className:styles.scrollList,children:/*#__PURE__*/_jsxs(\"ul\",{children:[item.parent&&/*#__PURE__*/_jsx(\"li\",{onClick:handleMove,\"data-key\":\"0\",children:\"Dashboard\"}),moveMenu.map(function(i){return/*#__PURE__*/_jsx(\"li\",{onClick:handleMove,\"data-key\":i.id,children:i.title},i.id);})]})}),/*#__PURE__*/_jsx(\"li\",{onClick:handleDelete,children:\"Delete\"})]})})]}),/*#__PURE__*/_jsx(\"h6\",{className:styles.heading,children:/*#__PURE__*/_jsx(Link,{to:\"/item/\".concat(item.id),as:\"/item/\".concat(item.id),children:item.title})}),/*#__PURE__*/_jsx(\"i\",{onClick:function onClick(){return setItemMenu(true);},className:\"material-icons right \".concat(styles.iconSmall),children:\"edit\"})]});}","map":{"version":3,"sources":["D:/Business/Programming/react_lists/src/components/ItemCard/ItemCardItem.js"],"names":["React","useState","useContext","styles","Link","useClickOutside","AppContext","ItemCardItem","item","maxIndex","itemMenu","setItemMenu","moveMenu","setMoveMenu","itemInput","setItemInput","items","children","dispatch","nextId","reduce","id","handleChange","e","target","name","value","prev","handleTitleSave","charCode","handleUpdate","title","test","type","payload","handleCopy","copy","JSON","parse","stringify","index","handleMoveMenu","availible","filter","i","parent","includes","handleMove","key","Number","dataset","length","console","log","handleDelete","domMenu","underlay","editWrap","editInput","menuWrap","icon","scrollList","map","heading","iconSmall"],"mappings":"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","sourcesContent":["import React, {useState, useContext} from 'react';\r\nimport styles from './ItemCard.module.css';\r\nimport { Link } from 'react-router-dom';\r\nimport { useClickOutside} from '../Helpers/ClickOutside';\r\nimport { AppContext } from '../../context/AppContext';\r\n\r\n\r\nexport default function ItemCardItem({item, maxIndex}) {\r\n    const [itemMenu, setItemMenu] = useState(false);\r\n    const [moveMenu, setMoveMenu] = useState(null)\r\n\r\n    const [itemInput, setItemInput] = useState(item)\r\n\r\n    const { items, children, dispatch } = useContext(AppContext);\r\n\r\n    const nextId = () => items.reduce((id, item)=>( item.id > id ? item.id : id), 0) + 1\r\n\r\n    const handleChange = (e) => {\r\n        const [name, value] = [e.target.name, e.target.value]\r\n        setItemInput(prev => {\r\n            return { ...prev, [name]:value }\r\n        })\r\n    }\r\n\r\n    const handleTitleSave = (e) => { if (e.charCode === 13) handleUpdate() }\r\n\r\n    const handleUpdate = () => {\r\n        if (! itemInput.title || /^\\s*$/.test(itemInput.title)) return\r\n\r\n        dispatch({\r\n            type:'UPDATE_ITEM',\r\n            payload: itemInput\r\n        });\r\n        setItemMenu(false)\r\n    }\r\n\r\n    const handleCopy = () =>{\r\n        let copy =  JSON.parse(JSON.stringify(item));\r\n        copy.id = nextId()\r\n        copy.index = maxIndex\r\n        copy.title = item.title + ' - copy'\r\n        dispatch({\r\n            type:'ADD_ITEM',\r\n            payload: copy\r\n        });\r\n        setItemMenu(false)\r\n    }\r\n\r\n    const handleMoveMenu = () => {\r\n        const availible = [...items].filter(i => item.id !== i.id && item.parent !== i.id && ! children(item).includes(i))\r\n        setMoveMenu(availible)\r\n    }\r\n\r\n    const handleMove = (e) => {\r\n        const key = Number(e.target.dataset.key)        \r\n        const copy = {...item}        \r\n        copy.parent = key > 0 ? key : null;\r\n        copy.index = items.filter(i => copy.parent === i.parent).length\r\n        console.log('index',copy.index)\r\n        dispatch({\r\n            type:'UPDATE_ITEM',\r\n            payload: copy\r\n        });\r\n        setMoveMenu(null)\r\n        setItemMenu(false)\r\n    }\r\n\r\n    const handleDelete = () => {\r\n        dispatch({\r\n            type:'DELETE_ITEM',\r\n            payload: item\r\n        });\r\n        setItemMenu(false)\r\n    }\r\n\r\n    let domMenu = useClickOutside(() => {\r\n        setItemMenu(false)\r\n    })\r\n    return (\r\n        <>  \r\n            {itemMenu &&\r\n            <div ref={domMenu}>\r\n                <div onClick={() => setItemMenu(false)} className={styles.underlay}></div>\r\n                <div className={`${styles.editWrap}`}>\r\n                    <input\r\n                        type=\"text\"\r\n                        placeholder=\"Title\"\r\n                        value={itemInput.title}\r\n                        name='title'\r\n                        className={`z-depth-5 ${styles.editInput}`}\r\n                        onChange={handleChange} \r\n                        onKeyPress={handleTitleSave}\r\n                    />\r\n                    <button onClick={handleUpdate} className=\"btn secondary\">Save</button>\r\n                </div>\r\n                <div className={`z-depth-5 ${styles.menuWrap}`}>\r\n                    <ul>\r\n                        <li><i onClick={() => setItemMenu(false)}className={`material-icons ${styles.icon}`}>close</i></li>\r\n                        <li onClick={handleCopy}>Copy</li>\r\n                        <li onClick={handleMoveMenu}>Move</li>\r\n                        { moveMenu &&\r\n                        <li className={styles.scrollList}>\r\n                            <ul>\r\n                                { item.parent && <li onClick={handleMove} data-key='0'>Dashboard</li>}\r\n                                {moveMenu.map((i)=>(\r\n                                <li onClick={handleMove} key={i.id} data-key={i.id}>{i.title}</li>\r\n                                ))}\r\n                            </ul>\r\n                        </li>}\r\n                        <li onClick={handleDelete}>Delete</li>\r\n                    </ul>\r\n                </div>\r\n            </div>}\r\n      \r\n\r\n            <h6 className={styles.heading}><Link to={`/item/${item.id}`} as={`/item/${item.id}`}>{item.title}</Link></h6>\r\n            <i onClick={()=>setItemMenu(true)} className={`material-icons right ${styles.iconSmall}`}>edit</i>\r\n\r\n        </>\r\n    )\r\n}\r\n"]},"metadata":{},"sourceType":"module"}
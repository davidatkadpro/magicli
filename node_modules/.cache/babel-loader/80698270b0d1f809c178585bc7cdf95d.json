{"ast":null,"code":"import _slicedToArray from\"D:/Business/Programming/react_lists/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _toConsumableArray from\"D:/Business/Programming/react_lists/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _objectSpread from\"D:/Business/Programming/react_lists/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import{createContext,useReducer,useEffect}from\"react\";import{jsx as _jsx}from\"react/jsx-runtime\";var AppReducer=function AppReducer(state,action){switch(action.type){case'ADD_ITEM':return _objectSpread(_objectSpread({},state),{},{items:[].concat(_toConsumableArray(state.items),[action.payload])});case'UPDATE_ITEM':return _objectSpread(_objectSpread({},state),{},{items:state.items.map(function(item){return item.id===action.payload.id?action.payload:item;})});case'DELETE_ITEM':// TODO crap futher down and delete all child items, also add a warning dialog\nreturn _objectSpread(_objectSpread({},state),{},{items:_toConsumableArray(state.items).filter(function(item){return item.id!==action.payload.id&&!getChildren(action.payload,state.items).includes(item);})});case'UPDATE_ITEMS':return _objectSpread(_objectSpread({},state),{},{items:state.items.map(function(item){action.payload.forEach(function(newItem){if(newItem.id===item.id){return newItem;}});return item;})});case'ADD_TAG':return _objectSpread(_objectSpread({},state),{},{tags:[].concat(_toConsumableArray(state.tags),[action.payload])});case'DELETE_TAG':return _objectSpread(_objectSpread({},state),{},{tags:_toConsumableArray(state.tags).filter(function(tag){return tag.id!==action.payload.id;}),items:[].concat(_toConsumableArray(state.items),[state.items.map(function(item){if(item.tags&&item.tags.includes(action.payload)){item.tags=item.tags.filter(function(tag){return tag!==action.payload.id;});}return item;})])});default:return state;}};var KEY='list-app';var getStore=function getStore(){return JSON.parse(localStorage.getItem(KEY));};var setStore=function setStore(data){localStorage.setItem(KEY,JSON.stringify(data));};var getChildren=function getChildren(item,items){var found=[];var crawl=function crawl(id,items){for(var i in items){if(items[i].parent===id&&!found.includes(items[i])){found.push(items[i]);crawl(items[i].id,items);}}};crawl(item.id,items);return found;};var initialState={tags:[{id:1,title:'Personal'}],items:[{id:1,title:'Title',description:'',tags:[],parent:null},{id:2,title:'Title 2',description:'',tags:[],parent:null},{id:3,title:'Title 3',description:'',tags:[],parent:2}]};export var AppContext=/*#__PURE__*/createContext();export var AppProvider=function AppProvider(props){var _useReducer=useReducer(AppReducer,getStore()||initialState),_useReducer2=_slicedToArray(_useReducer,2),state=_useReducer2[0],dispatch=_useReducer2[1];useEffect(function(){setStore(state);},[state]);return/*#__PURE__*/_jsx(AppContext.Provider,{value:{items:state.items,tags:state.tags,children:function children(item){return getChildren(item,state.items);},dispatch:dispatch},children:props.children});};","map":{"version":3,"sources":["D:/Business/Programming/react_lists/src/context/AppContext.js"],"names":["createContext","useReducer","useEffect","AppReducer","state","action","type","items","payload","map","item","id","filter","getChildren","includes","forEach","newItem","tags","tag","KEY","getStore","JSON","parse","localStorage","getItem","setStore","data","setItem","stringify","found","crawl","i","parent","push","initialState","title","description","AppContext","AppProvider","props","dispatch","children"],"mappings":"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","sourcesContent":["import { createContext, useReducer, useEffect } from \"react\";\r\n\r\nconst AppReducer = (state, action) => {\r\n    switch (action.type) {\r\n        case 'ADD_ITEM':\r\n            return {\r\n                ...state, \r\n                items: [...state.items, action.payload],\r\n            }\r\n        case 'UPDATE_ITEM':\r\n            return {\r\n                ...state, \r\n                items: state.items.map(\r\n                    (item) => item.id === action.payload.id ? action.payload : item\r\n                )\r\n            }  \r\n        case 'DELETE_ITEM':\r\n            // TODO crap futher down and delete all child items, also add a warning dialog\r\n            return {\r\n                ...state, \r\n                items: [...state.items].filter(item => item.id !== action.payload.id && ! getChildren(action.payload, state.items).includes(item) )\r\n            } \r\n        case 'UPDATE_ITEMS':\r\n            return {\r\n                ...state, \r\n                items: state.items.map((item) => {\r\n                    action.payload.forEach(newItem => {\r\n                        if (newItem.id === item.id){\r\n                            return newItem;\r\n                        }\r\n                    })\r\n                    return item;\r\n                })\r\n            }  \r\n        case 'ADD_TAG':\r\n            return {\r\n                ...state, \r\n                tags: [...state.tags, action.payload],\r\n            }\r\n        case 'DELETE_TAG':\r\n            return {\r\n                ...state, \r\n                tags: [...state.tags].filter(tag => tag.id !== action.payload.id),\r\n                items: [...state.items, state.items.map( (item) => {\r\n                    if (item.tags && item.tags.includes(action.payload)) {\r\n                        item.tags = item.tags.filter(tag => tag !== action.payload.id) }\r\n                    return item\r\n                })] \r\n            }        \r\n        default:\r\n            return state;\r\n    }\r\n}\r\nconst KEY = 'list-app';\r\nconst getStore = () =>{\r\n    return  JSON.parse(localStorage.getItem(KEY));\r\n}\r\nconst setStore = (data) =>{\r\n    localStorage.setItem(KEY, JSON.stringify(data));\r\n}\r\n\r\nconst getChildren = (item, items) => {\r\n    const found = []\r\n    const crawl = (id, items) =>{\r\n        for(var i in items) {\r\n            if (items[i].parent === id && ! found.includes(items[i]) ) {\r\n                found.push(items[i]);\r\n                crawl(items[i].id, items)\r\n            } \r\n        }\r\n    }\r\n    crawl(item.id, items)\r\n    return found\r\n}\r\n\r\nconst initialState = {\r\n    tags: [\r\n        {id:1, title:'Personal'}\r\n    ],\r\n    items:[\r\n        {id:1, title:'Title', description:'', tags:[], parent:null},\r\n        {id:2, title:'Title 2', description:'', tags:[], parent:null},\r\n        {id:3, title:'Title 3', description:'', tags:[], parent:2},\r\n    ]\r\n}\r\n\r\n\r\nexport const AppContext = createContext();\r\n\r\nexport const AppProvider = (props) =>{\r\n    const [state, dispatch] = useReducer(AppReducer, getStore() || initialState);\r\n\r\n    useEffect(() => {\r\n        setStore(state)\r\n    }, [state])\r\n\r\n    return (\r\n    <AppContext.Provider \r\n        value={{\r\n            items: state.items,\r\n            tags: state.tags,\r\n            children: (item) => getChildren(item, state.items), \r\n            dispatch,\r\n        }}\r\n    >\r\n        {props.children}\r\n    </AppContext.Provider>)\r\n}"]},"metadata":{},"sourceType":"module"}